---
import '../styles/global.css';
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { parseMeta } from '../lib/metatag';
import type { CollectionEntry } from 'astro:content';
export const prerender = true;

export async function getStaticPaths() {
  const pages = await getCollection('pages');
  return pages
    .filter((e) => !!e.data.alias)
    .map((entry) => ({
      params: { slug: entry.data.alias.replace(/^\//, '') },
      props: { entry },
    }));
}

interface Props { entry: CollectionEntry<'pages'> }
const { entry } = Astro.props;
const { title, body, images, metatag } = entry.data;
const meta = parseMeta(metatag);
---

<Layout
  title={meta.title ?? title}
  description={meta.description}
  ogTitle={meta.ogTitle}
  ogDescription={meta.ogDescription}
  ogImage={meta.ogImage}
>
  <div class="py-8">
    <div class="container mx-auto w-[80%]">
      <div class="lg:pl-[8%] grid grid-cols-1 gap-10 lg:grid-cols-2 lg:items-start">
        {images && images.length > 0 && images.map((img) => (
          <div class="flex items-center justify-center">
            <img
              src={img.src}
              alt={img.alt}
              width={img.width}
              height={img.height}
              loading="lazy"
              class="max-w-full max-h-full object-contain shadow"
            />
          </div>
        ))}

        <div class="space-y-6 lg:border-l lg:pl-10">
          <div>
            <h1 class="mt-2 text-4xl font-semibold">{title}</h1>
          </div>
          <article class="prose prose-lg max-w-none">
            <div set:html={body ?? ''} />
          </article>
        </div>
      </div>
    </div>
  </div>
</Layout>
